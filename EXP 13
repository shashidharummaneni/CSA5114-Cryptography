/* hill_known_plaintext.c
   Recover 2x2 Hill key from plaintext-ciphertext pairs.
   Compile: gcc hill_known_plaintext.c -o hill_known_plaintext -lm
   Usage: ./hill_known_plaintext
*/
#include <stdio.h>
#include <stdlib.h>

int mod26(int x){ x%=26; if (x<0) x+=26; return x; }

int egcd(int a,int b,int *x,int *y){
    if(b==0){ *x=1; *y=0; return a; }
    int x1,y1; int g=egcd(b,a%b,&x1,&y1);
    *x=y1; *y=x1 - (a/b)*y1;
    return g;
}
int modinv(int a,int m){
    int x,y; int g = egcd(a,m,&x,&y);
    if (g!=1) return -1;
    x%=m; if (x<0) x+=m; return x;
}

/* Inverse of 2x2 matrix A (mod 26). Returns 0 on success, -1 if non-invertible */
int inv2x2(int A[2][2], int Inv[2][2]){
    int det = mod26(A[0][0]*A[1][1] - A[0][1]*A[1][0]);
    int idet = modinv(det,26);
    if (idet == -1) return -1;
    Inv[0][0] = mod26(idet * A[1][1]);
    Inv[0][1] = mod26(idet * (-A[0][1]));
    Inv[1][0] = mod26(idet * (-A[1][0]));
    Inv[1][1] = mod26(idet * A[0][0]);
    return 0;
}

void mult2x2(int A[2][2], int B[2][2], int C[2][2]){
    for(int i=0;i<2;i++) for(int j=0;j<2;j++){
        C[i][j] = mod26(A[i][0]
